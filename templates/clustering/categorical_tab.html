{# Categorical tab. Using bootstrap classes. The tab container (div#statistics) and navigation links (ul#statistics_tab)
            are defined in statistics.html #}
<div class="tab-pane fade {% if categorical_tab %}show active{% endif %}" id="categorical_tab"
     role="tabpanel" aria-labelledby="c_settings_header">
    <div id="categorical_accordion">
        <div class="card">
            <div class="card-header" id="c_settings_header">
                <h5 class="mb-0">
                    <button class="btn btn-link" data-toggle="collapse" data-target="#categorical_settings"
                        {% if selected_c_entities %} aria-expanded="true" {% endif %} aria-controls="categorical_settings">
                        Settings
                    </button>
                </h5>
            </div>
            <div id="categorical_settings" class="collapse {% if not selected_c_entities or error %} show {% endif %}"
                 aria-labelledby="c_settings_header" data-parent="#categorical_accordion">
                <div class="card-body">
                    {% import 'macro_template.html' as m %}

                    {% if error %}
                    {{ m.show_error(error) }}
                    {% endif %}
                    <form action="" method="POST">
                        {{ m.entity_form4(id4= "measurement_cat",name =all_measurement,value=entity,select=measurement,d=name,block=block) }}
                        {{ m.entity_form2(id2= "categorical_entities",name =all_categorical_entities ,value=entity,select=categorical_entities,d="Categorical entities:") }}

                        <div class="row ml-1">
                            <button type="submit" name="cluster_categorical" class="btn btn-outline-info">Cluster</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" id="results_header">
                  <h5 class="mb-0">
                      <button class="btn btn-link" data-toggle="collapse" data-target="#categorical_results"
                              {% if selected_c_entities %} aria-expanded="true" {% endif %} aria-controls="#categorical_results">
                          Results
                      </button>
                </h5>
            </div>
            <div id="categorical_results" class="collapse {% if selected_c_entities %} show {% endif %}"
                 aria-labelledby="c_results_header" data-parent="#categorical_accordion">
                <div class="card-body">
                    {% if plot_c %}
                    <div id="cluster_c" >
                        {{plot_c | safe}}

                    </div>
                    {% endif %}
                    {% if ccv %}
                        <div class="dropdown mt-4 float-right">
                            <button class="btn btn-secondary btn-sm dropdown-toggle" type="button" id="export_button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Export table
                            </button>
                            <div class="dropdown-menu" aria-labelledby="export_button">
                                <a id='export_excel' class="dropdown-item">.xl</a>
                                <a id="export_csv" class="dropdown-item">.csv</a>
                            </div>
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Cluster</th>
                                    <th>Value</th>
                                    <th>Numer of patients</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for cluster, ccv_dict in ccv.items() %}
                                    {% for entity, value in ccv_dict.items() %}
                                    <tr>
                                        <td>{{ cluster }}</td>
                                        <td>{{ entity }}</td>
                                        <td>{{ value }}</td>
                                    </tr>
                                    {% endfor %}
                                {% endfor %}
                            </tbody>
                        </table>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>